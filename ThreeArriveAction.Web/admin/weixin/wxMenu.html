<!DOCTYPE html>
<html>
<head>
    <title>关注时回复</title>
    
    <link href="../skin/default/style.css" rel="stylesheet" type="text/css" />
    <link href="../skin/mystyle.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        thead td {
            font-weight: bolder;
            text-align: center;
            font-size: 18px;
            height: 30px;
        }

        tbody tr td label {
            width: 100px;
        }

        .txtNameValue, .txtNameKey, .txtNameUrl {
            padding: 1px 2px;
            line-height: 20px;
            border: 1px solid #d4d4d4;
            background: #fff;
            vertical-align: middle;
            color: #333;
            font-size: 100%;
            margin: 2px 0px 2px;
        }

        .txtNameValue {
            width: 150px;
        }

        .txtNameKey {
            width: 150px;
        }

        .txtNameUrl {
            width: 200px;
            margin-right: 10px;
        }

        .form_table td {
            border: 1px solid #e1e1e1;
        }

        .innertable td {
            border: 0px;
        }

        .td_shengru {
            text-align: center;
            width: 120px;
        }

        .td_titleName {
            width: 45px;
            text-align: center;
        }
    </style>
    


</head>

<body class="mainbody">
    <form id="form1">
        <!--内容-->
        <!--内容-->
        <div class="content-tab-wrap">
            <div id="floatHead" class="content-tab">
                <div class="content-tab-ul-wrap">
                    <ul>
                        <li><a href="javascript:;" onclick="tabs(this);" class="selected">设置自定义菜单</a></li>
                        <li><a href="javascript:;" onclick="tabs(this);">使用规则</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="tab-content">
            <table class="form_table">
                <thead>
                    <tr>
                        <td class="td_shengru">深度</td>
                        <td style="text-align: center;">第一列</td>
                        <td style="text-align: center;">第二列</td>
                        <td style="text-align: center;">第三列</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="td_shengru">一级菜单按钮</td>
                        <td>

                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text"  id="txtTop1" class="txtNameValue" name="txtTop1"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtTop1Key" class="txtNameKey" name="txtTop1Key" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtTop1Url" class="txtNameUrl"  name="txtTop1Url"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input id="txtTop2" class="txtNameValue" name="txtTop2" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input id="txtTop2Key" class="txtNameKey" name="txtTop2Key" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" class="txtNameUrl" id="txtTop2Url" name="txtTop2Url" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtTop3" name="txtTop3" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtTop3Key" name="txtTop3Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtTop3Url" name="txtTop3Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>
                    <tr>
                        <td colspan="3">
                            &nbsp;
                        </td>
                    </tr>

                    <tr>
                        <td class="td_shengru">二级菜单No.1</td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text"  id="txtMenu11" name="txtMenu11" class="txtNameValue"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu11Key" name="txtMenu11Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu11Url" name="txtMenu1Url" class="txtNameUrl" />
                                    </td>
                                </tr>

                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu21" name="txtMenu21" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu21Key" name="txtMenu21Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu21Url" name="txtMenu21Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu31" name="txtMenu31" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu31Key" name="txtName31Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text"  id="txtMenu31Url" name="txtMenu31Url" class="txtNameUrl"/>
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>

                    <tr>
                        <td class="td_shengru">二级菜单No.2</td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu12" name="txtMenu12" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu12Key" name="txtMenu12Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu12Url" name="txtMenu12Url" class="txtNameUrl" />
                                    </td>
                                </tr>

                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu22" class="txtNameValue" name="txtMenu22" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu22Key" name="txtMenu22Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu22Url"  name="txtMenu22Url" class="txtNameUrl"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu32"  name="txtMenu32" class="txtNameValue"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu32Key" name="txtMenu32Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu32Url"  name="txtMenu32Url" class="txtNameUrl"/>
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>


                    <tr>
                        <td class="td_shengru">二级菜单No.3</td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu13" name="txtMenu13" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu13Key" name="txtMenu13Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu13Url" name="txtMenu13Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu23" name="txtMenu23" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu23Key" name="txtMenu23Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu23Url" name="txtMenu23Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu33" name="txtMenu33" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu33Key" name="txtMenu33Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu33Url" name="txtMenu33Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>


                    <tr>
                        <td class="td_shengru">二级菜单No.4</td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu14" name="textMenu14" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu14Key" name="txtMenu14Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu14Url"name="txtMenu14Url" class="txtNameUrl"  />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td><input type="text" id="txtMenu24" name="txtMenu24" class="txtNameValue"/>
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu24Key" name="txtMenu24Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text"  id="txtMenu24Url" name="txtMenu24Url" class="txtNameUrl"/>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu34" name="txtMenu34" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu34Key" name="txtMenu34Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu34Url" name="txtMenu34Url" class="txtNameUrl"/>
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>
                    <tr>
                        <td class="td_shengru">二级菜单No.5</td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu15" name="txtMenu15" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text"  id="txtMenu15Key" name="txtMenu15Key" class="txtNameKey"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu15Url" name="txtMenu15Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu25" name="txtMenu25" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu25Key" name="txtMenu25Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu25Url" name="txtMenu25Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td>
                            <table border="0" class="innertable">
                                <tr>
                                    <td class="td_titleName">名称：</td>
                                    <td>
                                        <input type="text" id="txtMenu35" name="txtMenu35" class="txtNameValue" />
                                    </td>
                                </tr>

                                <tr>
                                    <td class="td_titleName">key：</td>
                                    <td>
                                        <input type="text" id="txtMenu35Key" name="txtMenu35Key" class="txtNameKey" />
                                    </td>
                                </tr>
                                <tr>
                                    <td class="td_titleName">url：</td>
                                    <td>
                                        <input type="text" id="txtMenu35Url" name="txtMenu35Url" class="txtNameUrl" />
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>

                </tbody>
            </table>
        </div>
        <div class="tab-content" style="display: none">
            <div style="padding-left: 20px; padding-bottom: 20px; line-height: 24px; font-size: 16px;">
                <h3>使用说明及规则，请仔细阅读</h3>
                <ul style="list-style-type: circle; padding-left: 20px;">

                    <li style="list-style-type: circle;">使用菜单需要成为“服务号”，或通过认证的“订阅号”，且开启了高级功能。到微信后台【高级功能 > 开发模式】下获取AppId和AppSecret，并且将这2个值填写在微信帐号相应位置。</li>
                    <li style="list-style-type: circle;">官方要求：一级菜单按钮个数为1-3个</li>
                    <li style="list-style-type: circle;">官方要求：如果设置了二级菜单按钮个数为1-5个</li>
                    <li style="list-style-type: circle;">官方要求：按钮描述，既按钮名字，不超过16个字节，子菜单不超过40个字节</li>
                    <li style="list-style-type: circle;">如果名称不填，此按钮将被忽略</li>
                    <li style="list-style-type: circle;">如果一级菜单为空，该列所有设置的二级菜单都会被忽略</li>
                    <li style="list-style-type: circle;">key对应自定义回复管理里的关键词</li>
                    <li style="list-style-type: circle;">key仅在SingleButton（单击按钮，无下级菜单）的状态下设置，如果此按钮有下级菜单，key将被忽略</li>
                    <li style="list-style-type: circle;">url为跳转到指定的页面。每个菜单key和Url只能填写一项，如果2个都填写，则按照Url跳转来设置</li>
                    <li style="list-style-type: circle;">所有二级菜单都为SingleButton，即子级菜单</li>
                    <li style="list-style-type: circle;">如果要快速看到微信上的菜单最新状态，需要重新关注，否则需要静静等待N小时</li>
                    <li style="list-style-type: circle;">
                        若仍有问题，请点击下面的按钮，更新Access_Token值【注：请慎用】<br />
                        <button id="btnFlushAT" type="button" class="btn">更新Access-Token值</button>
                    </li>
                </ul>
            </div>
        </div>


        <!--/内容-->
        <!--工具栏-->
        <div class="page-footer"  id="div_gongju">
            <div class="btn-list">
                <button id="btnSubmit" type="button" class="btn">生成自定义菜单</button>
                <button id="btnDelMenu" type="button" class="btn">删除当前菜单</button>
            </div>
            <div class="clear"></div>
        </div>
        <!--/工具栏-->
    </form>
    <script type="text/javascript" src="../../scripts/jquery/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="../../scripts/jquery/Validform_v5.3.2_min.js"></script>
    <script type="text/javascript" src="../../scripts/lhgdialog/lhgdialog.js?skin=idialog"></script>
    <script type="text/javascript" src="../../scripts/datepicker/WdatePicker.js"></script>
    <script type="text/javascript" src="../../scripts/swfupload/swfupload.js"></script>
    <script type="text/javascript" src="../../scripts/swfupload/swfupload.queue.js"></script>
    <script type="text/javascript" src="../../scripts/swfupload/swfupload.handlers.js"></script>
    <script type="text/javascript" charset="utf-8" src="../../editor/kindeditor-min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../../editor/lang/zh_CN.js"></script>
    <script type="text/javascript" src="../js/layout.js"></script>
    <script type="text/javascript">
        $(function () {
            //初始化表单验证
            $("#form1").initValidform();
            $.getJSON('../../Ajax/wxMenuManager.ashx?type=get', function (result) {
                if (result && result.success) {
                    if (result.topNum > 0) {
                        for (var i = 0; i < result.topNum; i++) {
                            var topBtnList = result.rows[i];//获取第一级菜单数据
                            //给对应的输入框赋值
                            $("#txtTop" + (i + 1)).val(topBtnList.txtTop + (i + 1));
                            $("#txtTop" + (i + 1)+"Key").val(topBtnList.txtTop + (i + 1)+"Key");
                            $("#txtTop" + (i + 1) + "Url").val(topBtnList.txtTop + (i + 1) + "Url");
                            if (topBtnList.subBtnList && topBtnList.subBtnList.length > 0) {
                                for (var j = 0; j < topBtnList.subBtnList.length;i++)
                                //子级菜单赋值
                                    $("#txtMenu" + (i + 1) + (j + 1)).val(topBtnList.subBtnList[j].txtMenu + (i + 1) + (j + 1));
                                $("#txtMenu" + (i + 1) + (j + 1)+"Key").val(topBtnList.subBtnList[j].txtMenu + (i + 1) + (j + 1)+"Key");
                                $("#txtMenu" + (i + 1) + (j + 1)+"Url").val(topBtnList.subBtnList[j].txtMenu + (i + 1) + (j + 1)+"Url");
                            }
                        }
                    }

                } else {
                   jsprint(result.msg,"","Error")
                }
            });

            //生成菜单事件
            $("#btnSubmit").click(function () {
                var data = $("form").serializeArray();
                $.post("../../Ajax/wxMenuManager.ashx?type=create", data, function (msg) {
                    var result = $.parseJSON(msg);
                    if (result && result.success) {
                        jsprint(result.msg,"","Success");
                    } else {
                        jsprint(result.msg, "", "False");
                    }
                });

            });
            //删除当前菜单事件
            $("#btnDelMenu").click(function () {
                $.post("../../Ajax/wxMenuManager.ashx?type=del", function (msg) {
                    var result = $.parseJSON(msg);
                    if (result && result.success) {
                        jsprint(result.msg, "", "Success");
                    } else {
                        jsprint(result.msg, "", "Error");
                    }
                });
            });
            //刷新Access_Token事件
            $("#btnFlushAT").click(function () {
                $.post("../../Ajax/wxMenuManager.ashx?type=flush", function (msg) {
                    var result = $.parseJSON(msg);
                    if (result && result.success) {
                        jsprint(result.msg, "", "Success");
                    } else {
                        jsprint(result.msg, "", "Error");
                    }
                });
            });
        });
    </script>
</body>
</html>
